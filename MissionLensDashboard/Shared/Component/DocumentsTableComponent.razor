@using Microsoft.AspNetCore.Components
@using MissionLensDashboard.Data

<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">Documents</h5>
        <div class="d-flex justify-content-end align-items-center gap-3">
            <button class="btn btn-primary" @onclick="() => ShowDialog = true">
                <i class="oi oi-plus"></i>
            </button>
        </div>

    </div>

    <div class="table-responsive">
        <table class="table align-middle">
            <thead class="table-light">
                <tr>
                    <th>User</th>
                    <th>Document</th>
                    <th>Category</th>
                    <th>Version</th>
                    <th>Embeddings Generated</th>
                    <th>Status</th>
                    <th>Approved</th>
                    <th>Available to Sub Entities</th>
                    <th>Expiry Date</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var doc in Documents)
                {
                    <tr>
                        <td>@doc.Name</td>
                        <td>@doc.Document</td>
                        <td>@doc.Category</td>
                        <td>@doc.Version</td>
                        <td>
                            <span class="badge bg-dark">@doc.EmbeddingsGenerated</span>
                        </td>
                        <td>
                            <span class="badge bg-success">@doc.Status</span>
                        </td>
                        <td>
                            <span class="text-success me-2">
                                <i class="bi bi-activity"></i>
                            </span>
                            @doc.Approved <br />
                        </td>
                        <td>
                            <span class="badge bg-success">@doc.Available</span>
                        </td>
                        <td>
                            <span class="badge bg-success">@doc.ExpiryDate</span>
                        </td>
                        <td>
                            <button class="btn btn-sm btn-outline-secondary me-1" @onclick="() => EditUser(doc)">
                                <i class="bi bi-pencil"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-danger" @onclick="() => DeleteUser(doc)">
                                <i class="bi bi-trash"></i>
                            </button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

@* <AddUserDialogComponent @ref="addUserDialogRef" IsOpen="@ShowDialog" IsOpenChanged="@((value) => ShowDialog = value)" OnSave="SaveUser" /> *@

@code {
    [Parameter] public List<DocumentModel> Documents { get; set; } = new();
    //private AddUserDialogComponent addUserDialogRef;
    private bool ShowDialog = false;

    private void EditUser(DocumentModel user)
    {
        // Open modal or navigate to edit page
        Console.WriteLine($"Edit user: {user.Name}");
    }

    private void DeleteUser(DocumentModel user)
    {
        // Show confirm dialog then delete
        Console.WriteLine($"Delete user: {user.Name}");
    }

    private void SaveUser(DocumentModel user)
    {
        Console.WriteLine($"User Added: {user.Name}, {user.Document}");
        // Save to DB or call API here
    }
}